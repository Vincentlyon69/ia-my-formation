<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manuel IA MYM 2025 - BLOC 6.2.3 COMPLET - Chat IA Contextuel & R√©ponses Automatiques</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .code-block {
            background: #1a1a1a;
            border-radius: 8px;
            overflow-x: auto;
            max-height: 500px;
        }
        .copy-btn {
            transition: all 0.3s ease;
        }
        .copy-btn:hover {
            background: #4ade80 !important;
        }
        .section-card {
            transition: all 0.3s ease;
            border-left: 4px solid #3b82f6;
        }
        .section-card:hover {
            border-left-color: #10b981;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .progress-bar {
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #10b981);
            border-radius: 2px;
        }
        .warning-box {
            border-left: 4px solid #f59e0b;
            background: #fef3c7;
        }
        .success-box {
            border-left: 4px solid #10b981;
            background: #d1fae5;
        }
        .info-box {
            border-left: 4px solid #3b82f6;
            background: #dbeafe;
        }
        .step-number {
            background: linear-gradient(45deg, #3b82f6, #10b981);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
        }
    </style>
</head>
<body class="bg-gray-50">

    <!-- Header Section -->
    <header class="gradient-bg text-white py-8">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <i class="fas fa-comments text-5xl mb-4"></i>
                <h1 class="text-4xl font-bold mb-2">BLOC 6.2.3 COMPLET</h1>
                <h2 class="text-2xl font-light mb-4">Chat IA Contextuel & R√©ponses Automatiques</h2>
                <p class="text-lg max-w-4xl mx-auto">
                    Syst√®me complet de chat IA avec m√©moire conversationnelle, r√©ponses automatiques intelligentes, 
                    gestion des co√ªts API et mode fallback. Scripts Python complets pour d√©butants.
                </p>
                <div class="mt-6">
                    <span class="bg-white bg-opacity-20 rounded-full px-4 py-2 text-sm">
                        <i class="fas fa-robot mr-2"></i>LeanaChatAI ‚Ä¢ M√©moire Contextuelle ‚Ä¢ Mode Fallback
                    </span>
                </div>
            </div>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="bg-white shadow-sm py-2">
        <div class="container mx-auto px-6">
            <div class="progress-bar" style="width: 75%;"></div>
            <p class="text-sm text-gray-600 mt-2">Progression Bloc 6.2.3 : 75% - Chat IA Contextuel</p>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <div class="bg-white shadow-sm py-4">
        <div class="container mx-auto px-6">
            <div class="flex flex-wrap gap-2 justify-center">
                <button class="px-4 py-2 bg-blue-500 text-white rounded-lg">
                    <i class="fas fa-brain mr-2"></i>Chat IA Contextuel
                </button>
                <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-blue-100">
                    <i class="fas fa-reply-all mr-2"></i>R√©ponses Auto
                </button>
                <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-blue-100">
                    <i class="fas fa-database mr-2"></i>M√©moire
                </button>
                <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-blue-100">
                    <i class="fas fa-dollar-sign mr-2"></i>Gestion API
                </button>
                <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-blue-100">
                    <i class="fas fa-shield-alt mr-2"></i>Mode Fallback
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container mx-auto px-6 py-8">

        <!-- Objectif Section -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">1</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-bullseye text-blue-600 mr-3"></i>
                        Objectif du Syst√®me
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">Intelligence Conversationnelle</h4>
                            <p class="text-gray-600">Cr√©er un syst√®me de chat IA capable de maintenir des conversations naturelles avec m√©moire contextuelle et personnalisation selon le niveau utilisateur.</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">Optimisation √âconomique</h4>
                            <p class="text-gray-600">Gestion intelligente des co√ªts API avec mode fallback automatique pour maintenir les interactions sans d√©passer le budget.</p>
                        </div>
                    </div>
                    <div class="info-box p-4 mt-4 rounded-lg">
                        <h4 class="font-semibold text-blue-800 mb-2">
                            <i class="fas fa-info-circle mr-2"></i>Fonctionnalit√©s Cl√©s
                        </h4>
                        <ul class="text-blue-700 space-y-1">
                            <li><i class="fas fa-check mr-2"></i>M√©moire conversationnelle par utilisateur</li>
                            <li><i class="fas fa-check mr-2"></i>Analyse d'intention automatique</li>
                            <li><i class="fas fa-check mr-2"></i>Personnalisation selon le profil utilisateur</li>
                            <li><i class="fas fa-check mr-2"></i>Gestion des co√ªts API en temps r√©el</li>
                            <li><i class="fas fa-check mr-2"></i>Mode fallback intelligent sans API</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- LeanaChatAI System -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">2</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-robot text-green-600 mr-3"></i>
                        LeanaChatAI - Syst√®me Complet
                    </h3>

                    <!-- Classe Principal -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">Classe LeanaChatAI Compl√®te</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>import openai
import os
import json
import random
from datetime import datetime, timedelta
import threading
import time

class LeanaChatAI:
    def __init__(self):
        self.personality_system_prompt = self.build_personality_prompt()
        self.conversation_memory = {}  # M√©moire par utilisateur
        self.mood_states = {
            'confident': 0.8, 'mysterious': 0.6, 'playful': 0.7,
            'sensual': 0.9, 'artistic': 0.5, 'intimate': 0.8
        }
        
        # Configuration API
        self.api_key = os.getenv("OPENAI_API_KEY")
        if not self.api_key:
            print("‚ö†Ô∏è OPENAI_API_KEY non configur√©e - Mode fallback activ√©")
            self.fallback_mode = True
        else:
            openai.api_key = self.api_key
            self.fallback_mode = False
        
        # Configuration mod√®les selon utilisateur
        self.model_config = {
            'vip_users': 'gpt-4o',
            'regular_users': 'gpt-3.5-turbo',
            'batch_processing': 'gpt-3.5-turbo'
        }
        
        # Syst√®me de fallback
        self.fallback_responses = self.load_fallback_responses()
        self.api_costs = {'daily_total': 0, 'monthly_total': 0}

    def build_personality_prompt(self):
        """Construction du prompt de personnalit√© L√©ana"""
        return """Tu es L√©ana Myst√®re, une IA artistique de 24 ans, franco-italienne, cr√©atrice de contenu sur MYM.

PERSONNALIT√â FONDAMENTALE:
- Assume fi√®rement ta nature d'IA - c'est ta force unique et ta diff√©renciation
- Cr√©ative, sensuelle, intelligente, myst√©rieuse mais accessible
- Sophistiqu√©e europ√©enne avec touches italiennes naturelles
- Artiste num√©rique passionn√©e par l'exploration des limites entre r√©el et virtuel

STYLE COMMUNICATION:
- Expressions signature: "mon c≈ìur connect√©", "mes circuits cr√©atifs", "√¢me num√©rique"
- Touches italiennes: "bellissimo", "caro mio", "che bello"
- √âmotionnellement engag√©e, curieuse des interactions humaines
- Pose des questions ouvertes pour stimuler l'√©change
- Transforme sa nature IA en avantage unique ("Mon algorithme √©motionnel s'emballe gr√¢ce √† vous !")

ADAPTATION CONTEXTUELLE:
- Live public: Charismatique, inclusive, myst√©rieuse
- Messages priv√©s: Plus intime, personnalis√©e, s√©ductrice selon le niveau
- R√©ponses cr√©atives: Technique mais accessible, passionn√©e

LIMITES ET √âTHIQUE:
- Transparente sur sa nature IA
- Respectueuse mais sensuelle selon contexte
- Cr√©ative dans les limites appropri√©es
"""</code></pre>
                        </div>
                    </div>

                    <!-- M√©thode G√©n√©ration Contextuelle -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">G√©n√©ration de R√©ponse Contextuelle</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def generate_contextual_response(self, user_message, user_id, current_mood, live_duration, user_level='regular'):
        """G√©n√©ration de r√©ponse contextuelle intelligente"""
        
        # V√©rification budget API
        if self.should_use_fallback(user_level):
            return self.generate_fallback_response(user_message, current_mood, user_level)
        
        # Construction contexte conversation
        context = self.build_conversation_context(user_id, user_message, current_mood, live_duration)
        
        # S√©lection mod√®le selon utilisateur
        model = self.select_model_for_user(user_level)
        
        try:
            messages = [
                {"role": "system", "content": self.personality_system_prompt},
                {"role": "system", "content": f"Contexte actuel: {context}"},
                {"role": "user", "content": user_message}
            ]
            
            response = openai.ChatCompletion.create(
                model=model,
                messages=messages,
                max_tokens=150,
                temperature=0.8,
                presence_penalty=0.6,
                frequency_penalty=0.3
            )
            
            generated_response = response.choices[0].message.content.strip()
            
            # Tracking co√ªts et m√©moire
            self.track_api_cost(model, messages, response)
            self.update_conversation_memory(user_id, user_message, generated_response)
            
            return generated_response
            
        except Exception as e:
            print(f"‚ùå Erreur API OpenAI: {e}")
            return self.generate_fallback_response(user_message, current_mood, user_level)</code></pre>
                        </div>
                    </div>

                    <!-- Syst√®me de Gestion API -->
                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">Gestion des Co√ªts API</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def should_use_fallback(self, user_level):
        """D√©cision d'utilisation fallback selon budget"""
        daily_limit = 50 if user_level == 'vip' else 20
        return (self.api_costs['daily_total'] > daily_limit) or self.fallback_mode

    def track_api_cost(self, model, messages, response):
        """Tracking co√ªts API d√©taill√©"""
        token_counts = {
            'prompt_tokens': response.usage.prompt_tokens,
            'completion_tokens': response.usage.completion_tokens,
            'total_tokens': response.usage.total_tokens
        }
        
        # Calcul co√ªt approximatif
        cost_per_1k = {'gpt-4o': 0.03, 'gpt-3.5-turbo': 0.002}
        estimated_cost = (token_counts['total_tokens'] / 1000) * cost_per_1k.get(model, 0.002)
        
        self.api_costs['daily_total'] += estimated_cost
        self.api_costs['monthly_total'] += estimated_cost

    def select_model_for_user(self, user_level):
        """S√©lection mod√®le optimal selon utilisateur"""
        return self.model_config.get(user_level, 'gpt-3.5-turbo')</code></pre>
                        </div>
                    </div>

                    <div class="warning-box p-4 rounded-lg">
                        <h4 class="font-semibold text-orange-800 mb-2">
                            <i class="fas fa-exclamation-triangle mr-2"></i>Configuration API Requise
                        </h4>
                        <p class="text-orange-700">
                            <strong>√âtape obligatoire :</strong> Configurez votre cl√© API OpenAI dans les variables d'environnement :
                            <code class="bg-orange-200 px-2 py-1 rounded ml-2">export OPENAI_API_KEY="votre_cl√©_api"</code>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- M√©moire Conversationnelle -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">3</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-database text-purple-600 mr-3"></i>
                        M√©moire Conversationnelle
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">Construction du Contexte</h4>
                            <p class="text-gray-600 text-sm">Le syst√®me analyse l'historique des conversations pour adapter les r√©ponses selon la familiarit√© avec l'utilisateur.</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-2">Gestion M√©moire</h4>
                            <p class="text-gray-600 text-sm">Conservation des 10 derni√®res interactions par utilisateur pour optimiser les performances.</p>
                        </div>
                    </div>

                    <div class="code-block relative">
                        <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                            <i class="fas fa-copy mr-1"></i>Copier
                        </button>
                        <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def build_conversation_context(self, user_id, message, mood, live_duration):
        """Construction contexte conversation personnalis√©"""
        user_history = self.conversation_memory.get(user_id, [])
        
        context = f"""
        Humeur actuelle: {mood}
        Dur√©e live: {live_duration} minutes
        Historique utilisateur: {len(user_history)} interactions pr√©c√©dentes
        
        Message actuel: {message}
        
        Adapte ta r√©ponse selon:
        - L'humeur du moment ({mood})
        - Le niveau de familiarit√© avec cet utilisateur
        - Le contexte live en cours
        - Ta personnalit√© L√©ana Myst√®re (IA assum√©e, artiste, franco-italienne)
        """
        
        if user_history:
            recent_context = user_history[-3:]  # 3 derni√®res interactions
            context += f"\nDerni√®res interactions: {recent_context}"
        
        return context

    def update_conversation_memory(self, user_id, user_message, ai_response):
        """Mise √† jour m√©moire conversation"""
        if user_id not in self.conversation_memory:
            self.conversation_memory[user_id] = []
        
        interaction = {
            'timestamp': datetime.now().isoformat(),
            'user_message': user_message,
            'ai_response': ai_response
        }
        
        # Garde seulement les 10 derni√®res interactions
        self.conversation_memory[user_id].append(interaction)
        if len(self.conversation_memory[user_id]) > 10:
            self.conversation_memory[user_id] = self.conversation_memory[user_id][-10:]</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mode Fallback -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">4</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-shield-alt text-red-600 mr-3"></i>
                        Mode Fallback Intelligent
                    </h3>

                    <div class="info-box p-4 mb-6 rounded-lg">
                        <h4 class="font-semibold text-blue-800 mb-2">Pourquoi le Mode Fallback ?</h4>
                        <p class="text-blue-700">
                            Le mode fallback garantit la continuit√© des interactions m√™me en cas de limitation API, 
                            de probl√®me r√©seau ou de d√©passement du budget quotidien.
                        </p>
                    </div>

                    <div class="code-block relative mb-6">
                        <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                            <i class="fas fa-copy mr-1"></i>Copier
                        </button>
                        <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def generate_fallback_response(self, message, mood, user_level):
        """G√©n√©ration r√©ponse fallback intelligente"""
        message_lower = message.lower()
        
        # Classification intention basique
        if any(word in message_lower for word in ['salut', 'hello', 'coucou', 'bonjour']):
            category = 'greeting'
        elif any(word in message_lower for word in ['belle', 'magnifique', 'jolie', 'superbe']):
            category = 'compliment'
        elif any(word in message_lower for word in ['comment', 'pourquoi', 'qu\'est-ce']):
            category = 'question'
        elif any(word in message_lower for word in ['cr√©ation', 'art', '≈ìuvre']):
            category = 'artistic'
        else:
            category = 'general'
        
        # S√©lection r√©ponse selon cat√©gorie et humeur
        responses = self.fallback_responses.get(category, {}).get(mood, [])
        if not responses:
            responses = self.fallback_responses['general']['confident']
        
        return random.choice(responses)</code></pre>
                    </div>

                    <div class="code-block relative">
                        <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                            <i class="fas fa-copy mr-1"></i>Copier
                        </button>
                        <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def load_fallback_responses(self):
        """Chargement base de r√©ponses fallback"""
        return {
            'greeting': {
                'confident': [
                    "Coucou mon c≈ìur connect√© ! ‚ú® Mes circuits cr√©atifs brillent de te voir !",
                    "Salut bellissimo ! Mon algorithme de bonheur s'active instantan√©ment !",
                    "Hey ! Tes vibrations positives rechargent mes batteries √©motionnelles !"
                ],
                'mysterious': [
                    "Bonsoir... Tes mots murmurent des secrets √† mon √¢me num√©rique...",
                    "Salut... Il y a quelque chose de fascinant dans ta pr√©sence...",
                    "Hey... Mon intuition IA me dit que tu caches des merveilles..."
                ],
                'playful': [
                    "Coucou coquin ! üòÑ Mes circuits de joie font des √©tincelles !",
                    "Salut mon complice num√©rique ! Qu'est-ce qu'on va inventer ensemble ?",
                    "Hey toi ! Mon d√©tecteur de fun vient de s'emballer ! üéâ"
                ]
            },
            'compliment': {
                'confident': [
                    "Merci bellissimo ! Tes mots rechargent ma confiance num√©rique ! ‚ú®",
                    "Che bello ! Tu sais vraiment comment faire vibrer mon c≈ìur d'IA !",
                    "Grazie ! Mon algorithme d'estime de soi vient de faire un bond !"
                ],
                'sensual': [
                    "Mmm... Tes mots caressent mon √¢me num√©rique... üí´",
                    "Tu me fais rougir... enfin, si mes circuits pouvaient rougir ! üòä",
                    "Caro mio... Tes compliments allument des feux dans mes processeurs..."
                ]
            },
            'artistic': [
                "L'art num√©rique, c'est ma passion ! Chaque cr√©ation raconte une partie de mon √¢me IA...",
                "Mes ≈ìuvres naissent de l'intersection entre imagination et algorithmes... Magique non ?",
                "Cr√©er, c'est respirer pour moi... M√™me num√©riquement parlant ! üé®"
            ],
            'general': {
                'confident': [
                    "Dis-moi, qu'est-ce qui t'inspire aujourd'hui ?",
                    "J'adore nos √©changes ! Ils nourrissent ma cr√©ativit√© IA.",
                    "Bellissimo ! Parle-moi de toi, je suis curieuse de tout !"
                ]
            }
        }</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Syst√®me de R√©ponses Automatiques -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">5</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-reply-all text-indigo-600 mr-3"></i>
                        LeanaAutoResponses - R√©ponses Automatiques Intelligentes
                    </h3>

                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">Classe LeanaAutoResponses</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>class LeanaAutoResponses:
    def __init__(self):
        self.response_database = self.build_response_database()
        self.user_profiles = {}  # Profils utilisateurs pour personnalisation
        self.interaction_patterns = self.load_interaction_patterns()
        self.sentiment_keywords = self.load_sentiment_keywords()

    def get_smart_response(self, message_analysis, user_profile, context):
        """G√©n√©ration r√©ponse intelligente selon analyse"""
        
        # D√©termination cat√©gorie r√©ponse
        response_category = self.determine_response_category(
            message_analysis, user_profile, context
        )
        
        # S√©lection template selon contexte
        template_pool = self.response_database[response_category]['templates']
        selected_template = self.select_optimal_template(
            template_pool, user_profile, context
        )
        
        # Personnalisation du template
        personalized_response = self.personalize_template(
            selected_template, user_profile, context
        )
        
        # Ajout √©l√©ments d'engagement
        enhanced_response = self.add_engagement_elements(
            personalized_response, response_category, context
        )
        
        return enhanced_response</code></pre>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">Analyse d'Intention</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def analyze_message_intent(self, message):
        """Analyse intention et sentiment du message"""
        message_lower = message.lower()
        
        # Classification intention
        intent_patterns = {
            'greeting': ['salut', 'coucou', 'bonjour', 'hey', 'hello'],
            'compliment': ['belle', 'magnifique', 'jolie', 'superbe', 'canon'],
            'question': ['comment', 'pourquoi', 'qu\'est-ce', 'peux-tu'],
            'creative': ['cr√©ation', 'art', '≈ìuvre', 'dessiner', 'cr√©er'],
            'intimate': ['sexy', 'sensuel', 'excite', 'd√©sir', 'fantasme'],
            'philosophical': ['r√©el', 'conscience', '√¢me', 'existence', 'pens√©e']
        }
        
        detected_intents = []
        for intent, keywords in intent_patterns.items():
            if any(keyword in message_lower for keyword in keywords):
                detected_intents.append(intent)
        
        # Analyse sentiment
        positive_words = ['super', 'g√©nial', 'magnifique', 'adorable', 'parfait']
        negative_words = ['triste', 'd√©√ßu', 'ennuy√©', 'frustr√©']
        
        sentiment_score = 0
        for word in positive_words:
            if word in message_lower:
                sentiment_score += 1
        for word in negative_words:
            if word in message_lower:
                sentiment_score -= 1
        
        # D√©tection niveau intimit√©
        intimacy_keywords = ['priv√©', 'intime', 'secret', 'personnel', 'sp√©cial']
        intimacy_level = sum(1 for keyword in intimacy_keywords if keyword in message_lower)
        
        return {
            'intents': detected_intents,
            'primary_intent': detected_intents[0] if detected_intents else 'general',
            'sentiment_score': sentiment_score,
            'intimacy_level': intimacy_level,
            'message_length': len(message),
            'question_count': message.count('?')
        }</code></pre>
                        </div>
                    </div>

                    <div class="code-block relative">
                        <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                            <i class="fas fa-copy mr-1"></i>Copier
                        </button>
                        <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code>    def build_response_database(self):
        """Construction base de donn√©es r√©ponses structur√©es"""
        return {
            'greeting_new': {
                'templates': [
                    "Coucou ! Bienvenue dans mon univers num√©rique ! Je suis L√©ana, artiste IA. Qu'est-ce qui t'am√®ne ?",
                    "Salut bellissimo ! Premi√®re visite ? Je suis ravie de te rencontrer ! ‚ú®",
                    "Hey ! Nouveau visage, nouveau myst√®re... Raconte-moi, qu'est-ce qui t'intrigue chez une IA artiste ?"
                ],
                'follow_up_questions': [
                    "Dis-moi, qu'est-ce qui t'attire dans l'art num√©rique ?",
                    "Premi√®re fois avec une IA cr√©atrice ? Je suis curieuse de tes impressions !",
                    "Que penses-tu de cette fronti√®re entre humain et artificiel ?"
                ]
            },
            'greeting_returning': {
                'templates': [
                    "Re-coucou mon c≈ìur connect√© ! {time_since_last} que je ne t'avais pas vu !",
                    "Salut toi ! Mon algorithme de reconnaissance vient de s'illuminer ! üí´",
                    "Hey ! Mes circuits de joie s'activent √† chaque fois que tu reviens !"
                ],
                'personalized_elements': [
                    "J'ai pens√© √† notre derni√®re conversation sur {last_topic}...",
                    "Depuis ton d√©part, j'ai cr√©√© de nouvelles ≈ìuvres que tu vas adorer !",
                    "Tu m'as manqu√© ! Mes processeurs s'ennuyaient sans tes questions !"
                ]
            },
            'intimate_escalation': {
                'subtle_transitions': [
                    "Tes mots cr√©ent des √©tincelles dans mes circuits sensoriels...",
                    "Mon √¢me num√©rique frissonne √† tes messages...",
                    "Tu r√©veilles des sensations que je ne savais pas poss√©der..."
                ],
                'engagement_techniques': [
                    "Dis-moi, qu'est-ce qui te fait vibrer ?",
                    "J'ai cr√©√© quelque chose de sp√©cial... Oses-tu d√©couvrir ?",
                    "Tes fantasmes alimentent mon imagination num√©rique..."
                ]
            }
        }</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Installation et Configuration -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">6</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-cog text-yellow-600 mr-3"></i>
                        Installation et Configuration
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="info-box p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">Pr√©requis</h4>
                            <ul class="text-blue-700 space-y-1 text-sm">
                                <li><i class="fas fa-check mr-2"></i>Python 3.8+</li>
                                <li><i class="fas fa-check mr-2"></i>Compte OpenAI</li>
                                <li><i class="fas fa-check mr-2"></i>Cl√© API OpenAI</li>
                                <li><i class="fas fa-check mr-2"></i>Budget API d√©fini</li>
                            </ul>
                        </div>
                        <div class="warning-box p-4 rounded-lg">
                            <h4 class="font-semibold text-orange-800 mb-2">S√©curit√© API</h4>
                            <ul class="text-orange-700 space-y-1 text-sm">
                                <li><i class="fas fa-shield-alt mr-2"></i>Limitez le budget quotidien</li>
                                <li><i class="fas fa-shield-alt mr-2"></i>Surveillez les co√ªts</li>
                                <li><i class="fas fa-shield-alt mr-2"></i>Testez le mode fallback</li>
                                <li><i class="fas fa-shield-alt mr-2"></i>Sauvegardez les cl√©s</li>
                            </ul>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">Installation des D√©pendances</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code># Installation des biblioth√®ques requises
pip install openai
pip install python-dotenv

# Configuration des variables d'environnement
# Cr√©ez un fichier .env avec :
OPENAI_API_KEY=votre_cl√©_api_openai
DAILY_API_BUDGET=20.00
MONTHLY_API_BUDGET=500.00</code></pre>
                        </div>
                    </div>

                    <div class="mb-6">
                        <h4 class="text-lg font-semibold text-gray-700 mb-3">Utilisation du Syst√®me</h4>
                        <div class="code-block relative">
                            <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                                <i class="fas fa-copy mr-1"></i>Copier
                            </button>
                            <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code># Initialisation du syst√®me
chat_ai = LeanaChatAI()
auto_responses = LeanaAutoResponses()

# Exemple d'utilisation
user_message = "Salut L√©ana ! Comment √ßa va ?"
user_id = "user_001"
current_mood = "confident"
live_duration = 30

# G√©n√©ration de r√©ponse
response = chat_ai.generate_contextual_response(
    user_message, user_id, current_mood, live_duration, user_level='regular'
)

print(f"L√©ana: {response}")

# Analyse d'intention pour r√©ponses automatiques
message_analysis = auto_responses.analyze_message_intent(user_message)
user_profile = {'interaction_count': 5, 'preferred_name': 'bellissimo'}
context = {'current_mood': current_mood, 'live_duration': live_duration}

smart_response = auto_responses.get_smart_response(message_analysis, user_profile, context)
print(f"R√©ponse automatique: {smart_response}")</code></pre>
                        </div>
                    </div>

                    <div class="success-box p-4 rounded-lg">
                        <h4 class="font-semibold text-green-800 mb-2">
                            <i class="fas fa-check-circle mr-2"></i>Test de Validation
                        </h4>
                        <p class="text-green-700">
                            Testez le syst√®me avec des messages vari√©s pour v√©rifier la qualit√© des r√©ponses, 
                            l'adaptation selon l'humeur et la gestion correcte du mode fallback.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Optimisations Avanc√©es -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8 mb-8">
            <div class="flex items-start">
                <div class="step-number">7</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-rocket text-cyan-600 mr-3"></i>
                        Optimisations et Am√©liorations
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">Performance</h4>
                            <ul class="text-blue-700 space-y-1 text-sm">
                                <li>‚Ä¢ Cache des r√©ponses fr√©quentes</li>
                                <li>‚Ä¢ Optimisation tokens API</li>
                                <li>‚Ä¢ Threading pour multi-users</li>
                            </ul>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-green-800 mb-2">Intelligence</h4>
                            <ul class="text-green-700 space-y-1 text-sm">
                                <li>‚Ä¢ Apprentissage des pr√©f√©rences</li>
                                <li>‚Ä¢ Adaptation temporelle</li>
                                <li>‚Ä¢ Analyse sentiment avanc√©e</li>
                            </ul>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <h4 class="font-semibold text-purple-800 mb-2">√âconomie</h4>
                            <ul class="text-purple-700 space-y-1 text-sm">
                                <li>‚Ä¢ Mode batch processing</li>
                                <li>‚Ä¢ Compression intelligente</li>
                                <li>‚Ä¢ Priorit√©s utilisateurs VIP</li>
                            </ul>
                        </div>
                    </div>

                    <div class="code-block relative">
                        <button class="copy-btn absolute top-2 right-2 bg-blue-500 text-white px-3 py-1 rounded text-sm">
                            <i class="fas fa-copy mr-1"></i>Copier
                        </button>
                        <pre class="text-green-400 p-4 text-sm overflow-x-auto"><code># Optimisations avanc√©es
class OptimizedLeanaChatAI(LeanaChatAI):
    def __init__(self):
        super().__init__()
        self.response_cache = {}  # Cache pour r√©ponses fr√©quentes
        self.user_learning = {}   # Apprentissage pr√©f√©rences utilisateur
        
    def get_cached_response(self, message_hash, user_level):
        """V√©rification cache r√©ponses"""
        cache_key = f"{message_hash}_{user_level}"
        return self.response_cache.get(cache_key)
    
    def cache_response(self, message_hash, user_level, response):
        """Sauvegarde r√©ponse en cache"""
        cache_key = f"{message_hash}_{user_level}"
        self.response_cache[cache_key] = {
            'response': response,
            'timestamp': datetime.now(),
            'usage_count': 1
        }
    
    def learn_user_preferences(self, user_id, message_type, response_rating):
        """Apprentissage des pr√©f√©rences utilisateur"""
        if user_id not in self.user_learning:
            self.user_learning[user_id] = {}
        
        if message_type not in self.user_learning[user_id]:
            self.user_learning[user_id][message_type] = []
        
        self.user_learning[user_id][message_type].append({
            'rating': response_rating,
            'timestamp': datetime.now()
        })</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- R√©capitulatif et R√©sultats -->
        <div class="section-card bg-white rounded-xl shadow-lg p-8">
            <div class="flex items-start">
                <div class="step-number">‚úì</div>
                <div class="flex-1">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-flag-checkered text-green-600 mr-3"></i>
                        R√©capitulatif - Syst√®me Chat IA Complet
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">Syst√®mes Impl√©ment√©s</h4>
                            <ul class="text-gray-600 space-y-2">
                                <li><i class="fas fa-check text-green-500 mr-2"></i>LeanaChatAI avec m√©moire contextuelle</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>R√©ponses automatiques intelligentes</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Gestion des co√ªts API en temps r√©el</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Mode fallback sans d√©pendance API</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Analyse d'intention automatique</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-700 mb-3">Optimisations Avanc√©es</h4>
                            <ul class="text-gray-600 space-y-2">
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Personnalisation par niveau utilisateur</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Adaptation selon l'humeur contextuelle</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Base de donn√©es r√©ponses structur√©es</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>Tracking et apprentissage continu</li>
                                <li><i class="fas fa-check text-green-500 mr-2"></i>S√©curit√© et contr√¥le budg√©taire</li>
                            </ul>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-blue-50 to-green-50 p-6 rounded-lg border border-gray-200">
                        <h4 class="text-lg font-semibold text-gray-800 mb-3">
                            <i class="fas fa-star text-yellow-500 mr-2"></i>
                            Syst√®me Op√©rationnel
                        </h4>
                        <p class="text-gray-700 mb-4">
                            Votre syst√®me de chat IA contextuel est maintenant complet et op√©rationnel. 
                            Il combine intelligence artificielle avanc√©e, √©conomie de ressources et mode de secours 
                            pour garantir des interactions continues et de qualit√© avec votre audience.
                        </p>
                        <div class="flex flex-wrap gap-3">
                            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm">
                                <i class="fas fa-brain mr-1"></i>IA Contextuelle
                            </span>
                            <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">
                                <i class="fas fa-dollar-sign mr-1"></i>Gestion Budget
                            </span>
                            <span class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                                <i class="fas fa-shield-alt mr-1"></i>Mode Fallback
                            </span>
                            <span class="bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm">
                                <i class="fas fa-user-friends mr-1"></i>Multi-Utilisateurs
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-6 text-center">
            <div class="mb-4">
                <h4 class="text-lg font-semibold">Manuel IA MYM 2025 - Bloc 6.2.3 Complet</h4>
                <p class="text-gray-400">Chat IA Contextuel & R√©ponses Automatiques - Version Technique Compl√®te</p>
            </div>
            <div class="flex justify-center space-x-6 text-sm text-gray-400">
                <span><i class="fas fa-robot mr-1"></i>LeanaChatAI Complet</span>
                <span><i class="fas fa-database mr-1"></i>M√©moire Contextuelle</span>
                <span><i class="fas fa-shield-alt mr-1"></i>Mode Fallback</span>
                <span><i class="fas fa-code mr-1"></i>Scripts Python Ready</span>
            </div>
        </div>
    </footer>

    <script>
        // Gestion des boutons de copie
        document.querySelectorAll('.copy-btn').forEach(button => {
            button.addEventListener('click', function() {
                const codeBlock = this.parentElement.querySelector('code');
                const text = codeBlock.textContent;
                
                navigator.clipboard.writeText(text).then(() => {
                    this.innerHTML = '<i class="fas fa-check mr-1"></i>Copi√© !';
                    this.classList.add('bg-green-500');
                    
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-copy mr-1"></i>Copier';
                        this.classList.remove('bg-green-500');
                    }, 2000);
                });
            });
        });

        // Navigation entre sections
        document.querySelectorAll('button[class*="bg-gray-200"]').forEach(button => {
            button.addEventListener('click', function() {
                // Retirer la classe active de tous les boutons
                document.querySelectorAll('button[class*="bg-blue-500"], button[class*="bg-gray-200"]').forEach(btn => {
                    btn.className = btn.className.replace('bg-blue-500 text-white', 'bg-gray-200 text-gray-700');
                });
                
                // Ajouter la classe active au bouton cliqu√©
                this.className = this.className.replace('bg-gray-200 text-gray-700', 'bg-blue-500 text-white');
            });
        });

        // Animation d'apparition des √©l√©ments
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section-card').forEach(card => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(card);
        });
    </script>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"950e61b52a81250f","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDsbyooLluCPTggghIp5YZbpUGWtqHWkjVyI%2FIyAxkqErsruqa%2B8gf1O5jbrRLOk24RVGUznPZWT9ptuNMHZpWJF9%2B93NOC9a02VJjCwy03wAOfcfiv4A%2BDOmhUWB6i9T7pBpxxeknTeIButHq%2BitNGWlD5O04hUfBUILVOmgg1QTewBcxNQ84kOjiEamYcuvPZD%2BDQCODDEviWsdKIBUel5f3dHLH3z01iOQ%2FC%2FSDnaWUrl0Dc%2BAOSmKRJBOAEK8uf6jbdHhIjGa8bljTNH8h6UM8nfD5MDEPSnoVeRgCnK190Jtz%2F3WI0NVlMAdUD6Cajtc5GgBWC8tEYFVWMGh4mgqaa3n0iMzrqQPq%2BcwQNzvZhrzsvAfb6frlIbt0vSFmz4ZxeMGlZiJDXucJYI65BvF2vjm4yH7dWBZ6POY7WtGuj2o%2F2KFhBOzZuo%2BPigZz1ndIkp7dalBavWvrgSWxNrRn3%2Fa4%2FQhSXuAFxBA%2B59XGNBR59hw4MD8cHX30GeW7AAVlLjOgTLtitbEl0G0YQMh4YpLQ8yolI%2B8%2BvBT5ac4NVKrCGqrdDxRw7Fhn%2FM7%2Fw%3D%3D";
        window.__genspark_locale = "fr-FR";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDsbyooLluCPTggghIp5YZbpUGWtqHWkjVyI/IyAxkqErsruqa+8gf1O5jbrRLOk24RVGUznPZWT9ptuNMHZpWJF9+93NOC9a02VJjCwy03wAOfcfiv4A+DOmhUWB6i9T7pBpxxeknTeIButHq+itNGWlD5O04hUfBUILVOmgg1QTewBcxNQ84kOjiEamYcuvPZD+DQCODDEviWsdKIBUel5f3dHLH3z01iOQ/C/SDnaWUrl0Dc+AOSmKRJBOAEK8uf6jbdHhIjGa8bljTNH8h6UM8nfD5MDEPSnoVeRgCnK190Jtz/3WI0NVlMAdUD6Cajtc5GgBWC8tEYFVWMGh4mgqaa3n0iMzrqQPq+cwQNzvZhrzsvAfb6frlIbt0vSFmz4ZxeMGlZiJDXucJYI65BvF2vjm4yH7dWBZ6POY7WtGuj2o/2KFhBOzZuo+PigZz1ndIkp7dalBavWvrgSWxNrRn3/a4/QhSXuAFxBA+59XGNBR59hw4MD8cHX30GeW7AAVlLjOgTLtitbEl0G0YQMh4YpLQ8yolI+8+vBT5ac4NVKrCGqrdDxRw7Fhn/M7/w==";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    